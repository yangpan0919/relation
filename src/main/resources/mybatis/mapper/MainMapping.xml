<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tzauto.dao.MainMapping">
    <insert id="add">
      insert  into relations (device_code,recipe_name,material_number,fixtureno) value (#{deviceCode},#{recipeName}, #{materialNumber},#{fixtureno})
    </insert>
    <update id="update">
        update relations set device_code = #{deviceCode},  recipe_name = #{recipeName} , material_number = #{materialNumber},fixtureno=#{fixtureno} where id = #{id}
    </update>
    <delete id="delete">
        delete from relations where id = #{id}
    </delete>

    <select id="getAll" resultType="com.tzauto.entity.RelationEntity">

    select * from  relations

    </select>
    <select id="query" resultType="com.tzauto.entity.RelationEntity">
        select * from  relations where
         fixtureno = #{fixtureno} and
          material_number = #{materialNumber}
          and device_code = #{deviceCode}

    </select>
    <select id="queryUser" resultType="java.lang.String">
 select login_name from  sys_user where login_name=#{name} and
 password = #{passWord}

    </select>

    <select id="queryLot" resultType="com.tzauto.entity.LotInfo">
            select
            lotid, starttime, lotnum, complete ,firstnum
              ,TARGET_NUM targetNum
     ,PAPER_NO paperNo
     ,LAYER
     ,MAIN_SERIAL mainSerial
     ,PART_NUM partNum
     ,WORK_NO workNo
     ,LAYER_NAME layerName
     ,SERIAL
     ,IS_MAIN isMain
     ,ORDER_ID orderId
     ,RECIPE_NAME recipeName
     ,OP_ID opId,
     device_code deviceCode,
     do_class doClass
             from lotinfo where lotid = #{lot};
    </select>
    <select id="selectMix" resultType="com.tzauto.entity.MixInfo">
         select lot,complete,layer from mix_info where lot = #{lot} and layer = #{layer}
    </select>
    <update id="updateMix">
        update mix_info set complete = #{complete}  where lot = #{lot} and layer = #{layer}
    </update>
    <insert id="lotInfoBak">
    insert into lotinfobak (select * from lotinfo where lotid = #{lot})
  </insert>
    <delete id="deleteLot">
        delete from  lotinfo where lotid = #{lot}
  </delete>
    <select id="deviceCodeList" resultType="string">
        SELECT device_code FROM md_device_info WHERE del_flag = '0' AND client_id =
				(
					SELECT PROPERTY_VAL from sys_property WHERE PROPERTY_KEY = 'clientId'
				)
    </select>
</mapper>
